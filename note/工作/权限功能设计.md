## 系统用户及权限功能设计

### 系统用户

#### 功能说明

1. 创建一个系统用户（包含系统用户的岗位关联，系统用户包含的角色）
   查询该组织下拥有的岗位（先做查询所有岗位）
   查询系统角色（先做查询所有角色）
4. 修改系统用户
5. 查询系统用户信息
4. 新增角色
5. 新增岗位

#### 流程说明

1. 创建系统用户

   新增用户后在新创建一个系统用户

2. 修改系统用户

3. 不单独删除系统用户系统用户在 员工删除时候跟着删除

4. 查询系统用户信息

#### 表说明

| 表名             | 说明                  |
| ---------------- | --------------------- |
| SYSTEM_USER      | 系统用户              |
| SYSTEM_USER_POST | 系统用户任职岗位      |
| SYSTEM_POST      | 系统岗位，配置表      |
| SYSTEM_USER_ROLE | 系统用户角色          |
| SYSTEM_ROLES     | 系统角色 ，一个配置表 |

#### api 说明

##### 查询组织下拥有的岗位

输入：根据组织id查询组织岗位

输出：表 ORG_POST_REL 、SYSTEM_POST

##### 查询岗位下拥有的角色

输入：根据岗位id查询角色

输出：表 SYSTEM_POST、SYSTEM_POST_ROLE 、SYSTEM_ROLES

##### 根据角色名称查询角色

输入：角色名称

输出：表 SYSTEM_ROLES

##### 新增系统用户涉及表及字段

SYSTEM_USER

| Name                 | Code            | 说明                                   |
| -------------------- | --------------- | -------------------------------------- |
| 系统用户标识         | SYS_USER_ID     |                                        |
| 员工标识             | STAFF_ID        | 先界面传递，后续在缓存中获取到         |
| 账号                 | SYS_USER_CODE   | 界面传递                               |
| 密码                 | PASSWORD        | 界面传递                               |
| 密码错误次数限制     | PWD_ERR_CNT     | 默认6                                  |
| 验证码短信通知手机号 | PWD_SMS_TEL     | 先不用                                 |
| 密码状态             | PWD_STATUS      | 新增默认有效                           |
| 新密码生成时间       | PWD_NEWTIME     | 默认创建时间                           |
| 密码有效天数         | PWD_EFFECT_DAYS | 默认90天                               |
| 区域标识             | REGION_ID       | 按照登陆的用户来传递，后续在缓存中获得 |
| 归属系统             | SYSTEM_INFO_ID  | 先不用                                 |
| 登录次数限制         | LIMIT_COUNT     | 先不用                                 |
| 当前登录次数         | LOGINED_NUM     | 先不用                                 |
| 系统用户描述         | SYS_USER_DESC   | 界面传递                               |
| 生效时间             | EFF_DATE        | 先不用                                 |
| 失效时间             | EXP_DATE        | 先不用                                 |
| 状态                 | STATUS_CD       | 默认生效                               |
| 状态时间             | STATUS_DATE     | 默认时间                               |
| 创建时间             | CREATE_DATE     | 默认时间                               |
| 创建人               | CREATE_STAFF    | 默认人员                               |
| 修改时间             | UPDATE_DATE     | 默认时间                               |
| 修改人               | UPDATE_STAFF    | 默认人员                               |



SYSTEM_USER_POST

| Name                 | Code             |                                |
| -------------------- | ---------------- | ------------------------------ |
| 系统用户任职岗位标识 | SYS_USER_POST_ID |                                |
| 系统用户标识         | SYS_USER_ID      |                                |
| 系统岗位标识         | SYS_POST_ID      |                                |
| 电信组织标识         | ORG_ID           | 先界面传递，后续在缓存中获取到 |
| 是否默认登录系统岗位 | DEFAULT_FLAG     |                                |
| 是否主岗位           | HOST_FLAG        |                                |
| 生效时间             | EFF_DATE         |                                |
| 失效时间             | EXP_DATE         |                                |
| 状态                 | STATUS_CD        |                                |
| 状态时间             | STATUS_DATE      |                                |
| 创建时间             | CREATE_DATE      |                                |
| 创建人               | CREATE_STAFF     |                                |
| 修改时间             | UPDATE_DATE      |                                |
| 修改人               | UPDATE_STAFF     |                                |

### 权限

页面权限、操作权限、数据权限

#### 权限与功能菜单

##### 功能说明

1. 前提要先有系统角色、权限、功能菜单
2. 给某一个角色授权，界面先展示功能权限的列表 先只做两级菜单。

##### 流程说明

​	是权限列在表格上还是功能菜单列在表格上

##### 相关表

##### api说明

#### 权限与数据

如何解决不同角色访问数据 不同 -福州只能查福州 ，厦门只能查厦门（不通过硬编码方式），只能查金额小于100 等等

  查询的sql语句要和权限相关联

##### 功能说明

1. 业务对象

##### 流程说明

##### 相关表

##### api说明

### 系统用户与权限



